<div class="reset-password-container">
    <div class="reset-password-card">
        <h1>Reset Password</h1>
        
        <div *ngIf="!email || !token" class="error-message">
            {{ errorMessage || 'Invalid reset link' }}
            <p class="back-to-login">
                <a routerLink="/auth/forget-password">Request new reset link</a>
            </p>
        </div>

        <div *ngIf="email && token">
            <p class="email-info">Resetting password for: <strong>{{ email }}</strong></p>

            <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
                <!-- New Password Input -->
                <div class="form-group position-relative">
                    <label for="newPassword">New Password</label>
                    <input
                        [type]="showPassword ? 'text' : 'password'"
                        id="newPassword"
                        formControlName="newPassword"
                        placeholder="Enter new password"
                        class="form-control pe-5"
                        [class.is-invalid]="resetPasswordForm.get('newPassword')?.invalid && resetPasswordForm.get('newPassword')?.touched"
                    />
                    <span class="password-toggle" (click)="togglePassword()">
                        {{ showPassword ? 'üôà' : 'üëÅÔ∏è' }}
                    </span>
                    
                    <!-- Password strength indicator -->
                    <small class="strength" [ngClass]="passwordStrength.toLowerCase()" *ngIf="resetPasswordForm.get('newPassword')?.value">
                        Strength: {{ passwordStrength }}
                    </small>

                    <div class="error-message" *ngIf="newPasswordErrors">
                        {{ newPasswordErrors }}
                    </div>
                </div>

                <!-- Confirm Password Input -->
                <div class="form-group position-relative">
                    <label for="confirmPassword">Confirm Password</label>
                    <input
                        [type]="showConfirmPassword ? 'text' : 'password'"
                        id="confirmPassword"
                        formControlName="confirmPassword"
                        placeholder="Confirm new password"
                        class="form-control pe-5"
                        [class.is-invalid]="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched"
                    />
                    <span class="password-toggle" (click)="toggleConfirmPassword()">
                        {{ showConfirmPassword ? 'üôà' : 'üëÅÔ∏è' }}
                    </span>

                    <div class="error-message" *ngIf="confirmPasswordErrors">
                        {{ confirmPasswordErrors }}
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="btn-submit" [disabled]="!resetPasswordForm.valid || loading">
                    <span *ngIf="!loading">Reset Password</span>
                    <span *ngIf="loading">
                        <span class="spinner"></span>
                        Resetting...
                    </span>
                </button>
            </form>
        </div>

        <!-- Success Message -->
        <div class="success-message" *ngIf="successMessage">
            {{ successMessage }}
            <p class="redirect-message">Redirecting to login...</p>
        </div>

        <!-- Back to Login Link -->
        <p class="back-to-login">
            <a routerLink="/auth/login">Back to Login</a>
        </p>
    </div>
</div>